# 路由器技术文档

SGLang路由器负责在多个调度器实例之间智能分发请求，实现负载均衡和高可用性。通过数据并行控制器和负载均衡算法，确保系统的水平扩展能力。

## 技术概览

路由器系统采用分层架构设计：
- **数据并行控制器**: 管理多个DP worker的请求分发
- **负载均衡算法**: 多种负载均衡策略的实现
- **健康检查**: 实时监控各个worker的健康状态
- **故障转移**: 自动的故障检测和流量转移

## 核心组件

### 负载均衡方法
```python
class LoadBalanceMethod:
    ROUND_ROBIN = auto()      # 轮询分配
    SHORTEST_QUEUE = auto()   # 最短队列优先
    MINIMUM_TOKENS = auto()   # 最少token数（推荐）
```

### 关键组件
- **DataParallelController**: 数据并行控制器
- **DPBalanceMeta**: 负载均衡元数据管理
- **LoadBalancer**: 负载均衡器接口

## 文档规划

### 核心内容（待编写）
1. **路由器架构设计** - 请求路由和分发机制
2. **数据并行控制** - DP worker管理和协调
3. **负载均衡算法** - 各种负载均衡策略的实现
4. **健康检查机制** - Worker状态监控和故障检测
5. **动态扩缩容** - 在线添加/移除worker节点
6. **请求追踪** - 跨worker的请求生命周期追踪
7. **性能优化** - 路由延迟和吞吐量优化
8. **配置管理** - 路由策略的配置和调优

### 技术特性
- **智能路由**: 基于实时负载的动态路由决策
- **高可用**: 自动故障检测和流量转移
- **可扩展**: 支持动态添加和移除节点
- **监控集成**: 完整的路由性能监控

## 开发状态

🚧 **文档开发中** - 此目录下的详细技术文档正在编写中，将涵盖SGLang路由器的完整实现细节。

## 相关代码路径
- `python/sglang/srt/managers/data_parallel_controller.py` - 数据并行控制器
- `python/sglang/srt/managers/utils.py` - 负载均衡工具类
- `sgl-router/` - Rust实现的高性能路由器
